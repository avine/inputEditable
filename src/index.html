<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <title>inputEditable</title>

  <link rel="stylesheet" href="inputEditable.css" />

  <script src="../node_modules/jquery/dist/jquery.min.js"></script>
  <script src="inputEditable.js"></script>

  <!--
  <script src="inputEditable.shim.js"></script>
  <script>
    $.fn.inputEditable.shim();
    $(document).ready(function () {
      // Use this to emulate old browser...
      $('form').each(function () { this.noValidate = true; });
    });
  </script>
  -->

  <style>
    * { outline: none; }

    body {
      font-size: 16px;
      font-family: Arial;
    }
    #log {
      margin: 20px 0;
      max-width: 300px;
      overflow: auto;
      border: 1px solid #ddd;
      padding: 0 20px;
      font: 14px normal monospace;
    }
    #log * {
      margin: 20px 0;
    }
  </style>
</head>
<body>

  <h1>inputEditable</h1>
  <h2>jQuery plugin that make any dom element editable</h2>

  <form action="#" id="edit1" class="edit-me" data-required data-placeholder="Fill me!" data-description="(edit me!)">
    15@a.com
  </form>

  <br />

  <form action="#" id="edit2" class="edit-me" data-placeholder="Fill me!" data-description="(edit me!)">
    30
  </form>

  <ol id="log"></ol>

  <script>

    var $editMe = $('.edit-me');

    var $log = $('#log');

    var events = [
      'ready', 'edit', 'cancel', 'notvalid', 'request', 'resolve', 'reject'
    ].map(function (event) {
      return event + '.inputEditable';
    }).join(' ');

    $editMe.on(events, function (e, data) {
      if ($log.children().length >= 5) {
        //$log.html('');
      }
      $log.append('<li>' + e.type + (data ? ' : ' + JSON.stringify(data) : '') + '</li>');
    });

    $('#edit1').inputEditable({
      type: 'email',
      customValidity: function (value) {
        return !/\.fr$/.test(value) ? 'Must end with .fr' : '';
      },
      submit: function(value, resolve) {
        setTimeout(function () {
          resolve();
        }, 2000);
      }
    });

    $('#edit2').inputEditable({
      customValidity: function (value) {
        return !/^[0-9]+$/.test(value) ? 'Number expected :-(' : '';
      },
      constraints: {
        required: true,
        maxlength: 10
      },
      submit: function(value, resolve) {
        setTimeout(function () {
          resolve();
        }, 2000);
      },
      toggleAtRight: true
    });

    /*
    // Use this to emulate old browser...
    $('input').on('invalid', function (e) {
      e.preventDefault();
      e.stopImmediatePropagation();
    });
    */

    $('input').on('invalid', function (e) {
      if ($log.children().length >= 5) {
        //$log.html('');
      }
      $log.append('<li>[native] ' + e.type + ' : ' + e.target.validationMessage + '</li>');
    });

    $log.click(function () {
      $log.html('');
    });
  </script>

</body>
</html>
